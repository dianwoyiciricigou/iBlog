(function(e){function t(t){for(var a,l,s=t[0],i=t[1],u=t[2],d=0,m=[];d<s.length;d++)l=s[d],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&m.push(n[l][0]),n[l]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);c&&c(t);while(m.length)m.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],a=!0,s=1;s<r.length;s++){var i=r[s];0!==n[i]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=r[0]))}return e}var a={},n={app:0},o=[];function l(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=e,l.c=a,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(r,a,function(t){return e[t]}.bind(null,a));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/admin/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=i;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var a=r("85ec"),n=r.n(a);n.a},"22de":function(e,t,r){"use strict";var a=r("8319"),n=r.n(a);n.a},"42c7":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},o=[],l=(r("034f"),r("2877")),s={},i=Object(l["a"])(s,n,o,!1,null,null,null),u=i.exports,c=r("5c96"),d=r.n(c);r("0fae");a["default"].use(d.a);var m,p,f=r("8c4f"),h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("el-row",{staticClass:"form"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"auto"}},[r("el-form-item",{attrs:{label:"邮箱",prop:"user"}},[r("el-input",{attrs:{type:"text",autocomplete:"off","prefix-icon":"el-icon-s-home"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",autocomplete:"off","show-password":"","prefix-icon":"el-icon-key"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1)],1)],1)],1)},b=[],v=(r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("96cf"),r("1da1")),w={data:function(){var e=function(e,t,r){if(""===t)r(new Error("请输入邮箱"));else{var a=/^[0-9a-zA-Z]+[-|0-9a-zA-Z._]+@\w+.[a-z]{2,}$/,n=a.test(t);n||r(new Error("邮箱格式不正确"))}r()},t=function(e,t,r){var a=/\w{6,12}/;""===t?r(new Error("请输入密码")):a.test(t)||r(new Error("输入的密码格式不正确")),r()};return{ruleForm:{},rules:{email:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this,r=new URLSearchParams;r.append("email",this.ruleForm.email),r.append("password",this.ruleForm.password),this.$refs[e].validate(function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=9;break}return e.next=3,t.$http.post("/login",r);case 3:n=e.sent,localStorage.token=n.data.token,t.$router.push("/admin/user"),t.$message.success("登录成功"),e.next=11;break;case 9:return console.log("error submit!!"),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},g=w,$=(r("d6db"),Object(l["a"])(g,h,b,!1,null,null,null)),x=$.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{staticStyle:{height:"100vh",border:"1px solid #eee"}},[r("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[r("el-menu",{attrs:{router:"","default-openeds":["1"],"default-active":"/admin/user"}},[r("el-submenu",{attrs:{index:"1"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-message"}),e._v("管理界面")]),r("el-menu-item-group",[r("el-menu-item",{attrs:{index:"/admin/user"}},[e._v("用户管理")]),r("el-menu-item",{attrs:{index:"/admin/article"}},[e._v("文章管理")])],1)],2)],1)],1),r("el-container",[r("el-header",{staticStyle:{"text-align":"right","font-size":"12px"}},[r("el-dropdown",[r("i",{staticClass:"el-icon-setting",staticStyle:{"margin-right":"15px"}}),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",[e._v("个人资料")]),r("el-dropdown-item",[e._v("退出登录")])],1)],1),r("span",[e._v("王小虎")])],1),r("el-main",[r("router-view")],1)],1)],1)},_=[],k=(r("cb29"),{data:function(){var e={date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"};return{tableData:Array(20).fill(e)}},methods:{},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/admin");case 2:r=t.sent,r.data._id&&(localStorage.uid=r.data._id);case 4:case"end":return t.stop()}}),t)})))()}}),E=k,O=(r("22de"),Object(l["a"])(E,y,_,!1,null,null,null)),j=O.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{offset:22}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/admin/userAdd")}}},[e._v("新增用户")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.model,stripe:"",border:""}},[r("el-table-column",{attrs:{prop:"_id",label:"ID",width:"250"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名",width:"180"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),r("el-table-column",{attrs:{prop:"role",label:"角色"}}),r("el-table-column",{attrs:{prop:"state",label:"状态"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(r){return e.$router.push("/admin/userEdit/"+t.row.username+"/"+t.row.email+"/"+t.row.role+"/"+t.row.state)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(r){return e.deleteUser(t.row.email)}}})]}}])})],1)],1)},C=[],R=(r("4160"),r("159b"),{data:function(){return{model:[]}},methods:{change:function(){this.model.forEach((function(e){e.role="admin"==e.role?"超级管理员":"普通用户",e.state=1==e.state?"启用":"禁用"}))},deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(Object(v["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$http.delete("/userEdit?email=".concat(e)),r.next=3,t.$http.get("/user");case 3:a=r.sent,t.model=a.data,t.$message.success("删除成功！");case 6:case"end":return r.stop()}}),r)})))).catch((function(){t.$message.info("已取消删除")}))}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/user");case 2:r=t.sent,e.model=r.data,e.change();case 5:case"end":return t.stop()}}),t)})))()}}),F=R,T=(r("e8c3"),Object(l["a"])(F,S,C,!1,null,null,null)),A=T.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(e.$route.params.username?"修改":"新建")+"用户")])]),r("el-form",{ref:"form",attrs:{model:e.model,"label-position":"top",rules:e.rules}},[r("el-form-item",{staticClass:"item",attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.username,callback:function(t){e.$set(e.model,"username",t)},expression:"model.username"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"邮箱",prop:"email"}},[e.$route.params.username?r("el-input",{attrs:{type:"text",autocomplete:"off",disabled:""},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}}):r("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"角色"}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.model.role,callback:function(t){e.$set(e.model,"role",t)},expression:"model.role"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{staticClass:"item",attrs:{label:"状态"}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.model.state,callback:function(t){e.$set(e.model,"state",t)},expression:"model.state"}},e._l(e.stateOpt,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v(e._s(e.$route.params.username?"修改":"新增"))])],1)],1)],1)},U=[],z={data:function(){var e=function(e,t,r){t||r(new Error("请输入用户名"));var a=/\w{2,16}/;a.test(t)||r(new Error("用户名格式不正确")),r()},t=function(e,t,r){t||r(new Error("请输入邮箱"));var a=/^[0-9a-zA-Z]+[-|0-9a-zA-Z._]+@\w+.[a-z]{2,}$/;a.test(t)||r(new Error("邮箱格式不正确")),r()},r=function(e,t,r){t||r(new Error("密码不能为空"));var a=/\w{2,16}/;a.test(t)||r(new Error("密码格式不正确")),r()};return{model:{role:"",state:""},options:[{value:"普通用户",label:"普通用户"},{value:"超级管理员",label:"超级管理员"}],stateOpt:[{value:"启用",label:"启用"},{value:"禁用",label:"禁用"}],rules:{username:[{validator:e,trigger:"blur"}],email:[{validator:t,trigger:"blur"}],password:[{validator:r,trigger:"blur"}]}}},mounted:function(){for(var e in this.$route.params)this.$set(this.model,e,this.$route.params[e])},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("表单中有错误，请检查仔细重新填写"),!1;t.$route.params.username?(t.change(),t.$http.put("/userEdit",t.model).then((function(e){"ok"==e.data&&t.$message.success("修改用户成功"),t.$router.push("/admin/user")}))):(t.change(),t.$http.post("/userEdit",t.model).then((function(e){"ok"==e.data&&t.$message.success("添加用户成功"),t.$router.push("/admin/user")})))}))},change:function(){this.model.role="超级管理员"==this.model.role?"admin":"normal",this.model.state="启用"==this.model.state?1:0}}},I=z,D=(r("a176"),Object(l["a"])(I,P,U,!1,null,null,null)),B=D.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{offset:22}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/admin/articleAdd/"+e.uid)}}},[e._v("新增文章")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.model,stripe:"",border:""}},[r("el-table-column",{attrs:{prop:"_id",label:"ID",width:"250"}}),r("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),r("el-table-column",{attrs:{prop:"updateT",label:"发布时间"}}),r("el-table-column",{attrs:{prop:"author.username",label:"作者"}}),r("el-table-column",{attrs:{prop:"option",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(r){return e.$router.push("/admin/articleEdit/"+t.row._id+"/"+t.row.title+"/"+t.row.author._id)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(r){return e.deleteUser(t.row._id)}}})]}}])})],1)],1)},M=[],Z=(r("ac1f"),r("1276"),{data:function(){return{uid:"",model:[]}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/article");case 2:r=t.sent,e.model=r.data,e.uid=localStorage.uid,e.model.forEach((function(t,r){e.model[r].updateT=e.model[r].updateT.split("T")[0]}));case 6:case"end":return t.stop()}}),t)})))()},methods:{deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(v["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.delete("/articleEdit?aid=".concat(e));case 2:return a=r.sent,"ok"==a.data&&t.$message.success("删除成功!"),r.next=6,t.$http.get("/article");case 6:n=r.sent,t.model=n.data;case 8:case"end":return r.stop()}}),r)})))).catch((function(){t.$message.info("已取消删除")}))}}}),V=Z,H=Object(l["a"])(V,L,M,!1,null,null,null),J=H.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[r("span",[e._v("卡片名称")])]),r("el-form",{ref:"form",attrs:{model:e.model,"label-position":"top",rules:e.rules}},[r("el-form-item",{staticClass:"item",attrs:{label:"标题",prop:"title"}},[r("el-input",{model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"作者"}},[r("el-input",{attrs:{disabled:""},model:{value:e.model.author,callback:function(t){e.$set(e.model,"author",t)},expression:"model.author"}})],1),r("el-form-item",{staticClass:"item",attrs:{label:"发布时间",prop:"updateT"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.model.updateT,callback:function(t){e.$set(e.model,"updateT",t)},expression:"model.updateT"}})],1),r("el-form-item",{staticClass:"item cover",attrs:{label:"文章封面",prop:"cover"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.$http.defaults.baseURL+"/upload","show-file-list":!0,"on-success":e.afterUpload}},[e.model.cover?r("img",{staticClass:"avatar",attrs:{src:e.model.cover}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{staticClass:"editor",attrs:{label:"内容",prop:"content"}},[r("vue-editor",{attrs:{useCustomImageHandler:""},on:{"image-added":e.handleImageAdded},model:{value:e.model.content,callback:function(t){e.$set(e.model,"content",t)},expression:"model.content"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v(e._s(this.$route.params._id?"修改":"新增"))])],1)],1)],1)},q=[],G=r("5873"),K=function(e,t,r){t||r(new Error("请输入标题")),r()},Q=function(e,t,r){t||r(new Error("请选择时间")),r()},W={components:{VueEditor:G["a"]},data:function(){return{model:{title:"",cover:"",content:""},rules:{title:[{validator:K,trigger:"blur"}],updateT:[{validator:Q,trigger:"blur"}]}}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$route.params.uid){t.next=2;break}return t.abrupt("return",e.model.author=e.$route.params.uid);case 2:return e.model.author=e.$route.params.userID,e.model.title=e.$route.params.title,t.next=6,e.$http.get("/articleEdit?_id=".concat(e.$route.params._id));case 6:r=t.sent,e.model.content=r.data.content,e.model.cover=r.data.cover;case 9:case"end":return t.stop()}}),t)})))()},methods:{afterUpload:function(e){this.model.cover=e.url},handleImageAdded:function(e,t,r,a){var n=this;return Object(v["a"])(regeneratorRuntime.mark((function o(){var l,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return l=new FormData,l.append("image",e),o.next=4,n.$http.post("/upload",l);case 4:s=o.sent,t.insertEmbed(r,"image",s.data.url),a();case 7:case"end":return o.stop()}}),o)})))()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("表单中有错误，请检查仔细重新填写"),!1;t.$route.params._id?t.$http.put("/articleEdit?_id=".concat(t.$route.params._id),t.model).then((function(e){"ok"==e.data&&t.$message.success("修改文章成功"),t.$router.push("/admin/article")})):t.$http.post("/articleAdd",t.model).then((function(e){"ok"==e.data&&t.$message.success("添加文章成功"),t.$router.push("/admin/article")}))}))}}},X=W,Y=(r("5794"),Object(l["a"])(X,N,q,!1,null,null,null)),ee=Y.exports,te={},re=Object(l["a"])(te,m,p,!1,null,null,null),ae=re.exports;a["default"].use(f["a"]);var ne=[{path:"/admin",name:"Main",component:j,children:[{path:"/admin/user/",component:A},{path:"/admin/userAdd",component:B},{path:"/admin/userEdit/:username/:email/:role/:state",component:B},{path:"/admin/article/",component:J},{path:"/admin/articleAdd/:uid",component:ee},{path:"/admin/articleEdit/:_id/:title/:userID",component:ee}]},{path:"/home",name:"Home",component:ae},{path:"/login",name:"Login",component:x,meta:{isPublic:!0}}],oe=new f["a"]({routes:ne});oe.beforeEach((function(e,t,r){if(!e.meta.isPublic&&!localStorage.token)return r("/login");r()}));var le=oe,se=r("bc3a"),ie=r.n(se);ie.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var ue=ie.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/admin/"}).VUE_APP_API_URL||"/admin/api"});ue.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+localStorage.token,e}),(function(e){return Promise.reject(e)})),ue.interceptors.response.use((function(e){return e}),(function(e){return e.response.data.msg&&a["default"].prototype.$message.error(e.response.data.msg),401===e.response.status&&le.push("/login"),Promise.reject(e)}));var ce=ue;a["default"].config.productionTip=!1,a["default"].prototype.$http=ce,new a["default"]({router:le,render:function(e){return e(u)}}).$mount("#app")},5794:function(e,t,r){"use strict";var a=r("76e5"),n=r.n(a);n.a},"76e5":function(e,t,r){},"7be2":function(e,t,r){},8319:function(e,t,r){},"85ec":function(e,t,r){},a176:function(e,t,r){"use strict";var a=r("42c7"),n=r.n(a);n.a},d6db:function(e,t,r){"use strict";var a=r("e67a"),n=r.n(a);n.a},e67a:function(e,t,r){},e8c3:function(e,t,r){"use strict";var a=r("7be2"),n=r.n(a);n.a}});
//# sourceMappingURL=app.07e33ac9.js.map